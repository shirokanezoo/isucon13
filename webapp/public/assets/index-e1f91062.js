import{R as f,p as v,j as e,M as S,c as C,D as w,d as L,S as a,I as p,q as T,B as b,r as A,b as D,h as q,H as F,T as y,G as u,n as O,L as R,C as k,A as G}from"./index-55457d82.js";import{u as I,C as B}from"./index.esm-bd2deef7.js";import{F as c,a as x}from"./FormLabel-c342aa29.js";import{T as H}from"./Textarea-5dd4cd67.js";function M(t){const[m,h]=f.useState(!1),n=I({defaultValues:{title:"",description:"",startAt:"",endAt:"",tags:[]}}),r=v(),j=n.handleSubmit(async s=>{if(t.onSubmit){h(!0);try{await t.onSubmit(s),t.onClose()}finally{h(!1)}}n.reset()});return e.jsx(e.Fragment,{children:e.jsx(S,{open:t.isOpen,onClose:t.onClose,children:e.jsxs(C,{size:"lg",sx:{minWidth:"600px"},children:[e.jsx(w,{children:"予約配信の作成"}),e.jsx(L,{children:"配信内容を入力してください。"}),e.jsx("form",{onSubmit:j,children:e.jsxs(a,{spacing:2,children:[e.jsxs(c,{children:[e.jsx(x,{children:"タイトル"}),e.jsx(p,{required:!0,...n.register("title")})]}),e.jsxs(c,{children:[e.jsx(x,{children:"説明文"}),e.jsx(H,{required:!0,minRows:3,...n.register("description")})]}),e.jsxs(c,{children:[e.jsx(x,{children:"タグ"}),e.jsx(B,{control:n.control,name:"tags",render:({field:s})=>{var i,o,l;return e.jsx(T,{options:((i=r.data)==null?void 0:i.tags)??[],getOptionLabel:g=>g.name,onChange:(g,d)=>s.onChange(d?[d.id]:[]),value:((l=(o=r.data)==null?void 0:o.tags)==null?void 0:l.find(g=>{var d;return g.id===((d=s.value)==null?void 0:d[0])}))??null,loading:r.isLoading})}})]}),e.jsxs(c,{children:[e.jsx(x,{children:"開始日時 2024年04月から指定可能"}),e.jsx(p,{type:"datetime-local",required:!0,...n.register("startAt")})]}),e.jsxs(c,{children:[e.jsx(x,{children:"終了日時 2025年4月末まで指定可能"}),e.jsx(p,{type:"datetime-local",required:!0,...n.register("endAt")})]}),e.jsx(b,{type:"submit",loading:m,children:"作成"})]})})]})})})}function Q(){var j;const[t,m]=f.useState(!1),h=A(),n=D(),r=f.useCallback(async s=>{try{await q.post$livestream$reservation({requestBody:{title:s.title,description:s.description,tags:s.tags,collaborators:[],start_at:new Date(s.startAt).valueOf()/1e3,end_at:new Date(s.endAt).valueOf()/1e3}})}catch(i){let o="配信の作成に失敗しました";if(i instanceof F&&i.response.status===400){const l=await i.response.json();l.message&&(o=l.message)}throw n.add({type:"error",title:"配信の作成に失敗しました",message:o},{timeout:5e3}),i}},[]);return e.jsxs(e.Fragment,{children:[e.jsx(M,{isOpen:t,onClose:()=>m(!1),onSubmit:r}),e.jsx(a,{sx:{mx:2,my:3},gap:3,children:e.jsxs(_,{children:[e.jsx(y,{level:"h3",children:"配信一覧"}),e.jsx(a,{sx:{display:"block",my:3},children:e.jsx(b,{onClick:()=>m(!0),children:"予約配信を作成"})}),e.jsx(u,{container:!0,spacing:3,columns:1,flexGrow:1,sx:{padding:2},children:(j=h.data)==null?void 0:j.map(s=>e.jsx(u,{xs:1,children:e.jsx($,{liveSteram:s})},s.id))})]})})]})}const _=O.div`
  width: 1000px;
  margin: 0 auto;
`;function $(t){return e.jsx(R,{to:`/console/live/${t.liveSteram.id}`,style:{textDecoration:"none"},children:e.jsx(k,{children:e.jsxs(u,{container:!0,columns:4,spacing:3,children:[e.jsx(u,{xs:1,children:e.jsx(G,{sx:{borderRadius:10},children:e.jsx("img",{src:"https://images.unsplash.com/photo-1527549993586-dff825b37782?auto=format&fit=crop&w=400",loading:"lazy"})})}),e.jsx(u,{xs:2,children:e.jsxs(a,{direction:"column",spacing:1,sx:{marginTop:1},children:[e.jsx(y,{level:"title-sm",children:t.liveSteram.title}),e.jsxs(y,{level:"body-sm",component:"div",children:[e.jsx(a,{direction:"row",spacing:2,children:e.jsx("span",{children:"1234人視聴・12分前"})}),e.jsxs(a,{direction:"row",spacing:2,children:[e.jsx("span",{children:"開始 2023-10-10 12:23"}),e.jsx("span",{children:"終了 2023-10-10 12:23"})]})]})]})})]})})})}export{Q as default};
